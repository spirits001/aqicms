{% load cms %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <title>{{ static.site_name }}</title>
    {% include "default/include/common.html" %}
</head>
<body>
<div class="app-layout-canvas">
    <div class="app-layout-container">
        {% include "default/include/header.html" %}
        <main class="app-layout-content">
            <figure class="banner bg-img bg-inverse" data-height="200" style="background-image: url(/static/assets/img/photos/banner-s.png)">
                <figcaption class="banner-caption">
                    <div class="container">
                        <div class="row text-center fa-3x"></div>
                        <!-- .row -->
                    </div>
                    <!-- .container -->
                </figcaption>
            </figure>
            <div class="section p-b-xl bg-white">
                <div class="container">
                    <div class="collapse navbar-collapse hidden-sm hidden-xs" id="header-navbar-collapse">
                        <div class="pull-right bg-inverse p-t-md text-black">共计<strong> {{ count }}</strong> 条搜索结果</div>
                    </div>
                    <div class="m-t-md clearfix" id="res">
                        <ul class="list-simple cms-list list-unstyled">
                            {% for item in articles %}
                                <li class="media p-y b-t">
                                    <div class="media-left p-r-md">
                                        {% if item.img %}
                                            <a href="{{ item|get_link:'a' }}" target="_blank"><img src="{{ item.img.url|resize:'200x117' }}"></a>
                                        {% endif %}
                                    </div>
                                    <div class="media-body">
                                        <a class="text-xl" href="{{ item|get_link:'a' }}" target="_blank">{{ item.title }}</a>
                                        <div class="m-t">{{ item.description }}</div>
                                        <div class="artInfo m-t">
                                            <span class="m-r-md">浏览数： {{ item.num }}</span>
                                            <span>发布：{{ item.show_time|date:"Y-m-d" }}</span>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% if articles.paginator.page_range.1 > 1 %}
                        <nav aria-label="Page navigation">
                            <ul class="pagination">
                                {% if articles.has_previous %}
                                    <li>
                                        <a href="?page={{ articles.previous_page_number }}" aria-label="Previous">
                                            <span aria-hidden="true">&laquo;</span>
                                        </a>
                                    </li>
                                {% endif %}
                                {% if articles.number > 5 %}
                                    <li><a href="?page=1">1</a></li>
                                    {% if articles.number > 6 %}
                                        ...
                                    {% endif %}
                                {% endif %}
                                {% for num in articles.paginator.page_range %}
                                    {% if num == articles.number %}
                                        <li class="active"><a href="?page={{ num }}">{{ num }}</a></li>
                                    {% elif articles.number < 5 and num < 11 or num > articles.number|add:-5 and num < articles.number|add:5 %}
                                        <li><a href="?page={{ num }}">{{ num }}</a></li>
                                    {% endif %}
                                {% endfor %}
                                {% if articles.number|add:4 < articles.paginator.num_pages and articles.paginator.num_pages > 10 %}
                                    {% if articles.number|add:5 < articles.paginator.num_pages %}
                                        ...
                                    {% endif %}
                                    <li><a href="?page={{ articles.paginator.num_pages }}">{{ articles.paginator.num_pages }}</a></li>
                                {% endif %}
                                {% if articles.has_next %}
                                    <li>
                                        <a href="?page={{ articles.next_page_number }}" aria-label="Next">
                                            <span aria-hidden="true">&raquo;</span>
                                        </a>
                                    </li>
                                {% endif %}
                            </ul>
                        </nav>
                    {% endif %}
                </div>
            </div>
        </main>
    </div>
</div>
<script src="/static/assets/js/core/jquery.min.js"></script>
<script src="/static/assets/js/core/bootstrap.min.js"></script>
<script src="/static/assets/js/core/jquery.slimscroll.min.js"></script>
<script src="/static/assets/js/core/jquery.scrollLock.min.js"></script>
<script src="/static/assets/js/core/jquery.placeholder.min.js"></script>
<script src="/static/assets/js/app.js"></script>
<script src="/static/assets/js/app-custom.js"></script>
<script>
    $(function () {
        var getkeywords = GetQueryString("keywords");
        var symbol = /[+]/g;
        var keywords = getkeywords.replace(symbol, " ");
        if (keywords) {
            $("#keywords").val(keywords);
            var keys = keywords.split(" ");
            var reshtml = $("#res").html();
            for (var i = 0; i < keys.length; i++) {
                reshtml = reshtml.replace(new RegExp(keys[i], 'g'), "<span class='text-red'>" + keys[i] + "</span>")
            }
            $("#res").html(reshtml);
        } else {
            $("#keywords").val("");
            keywords = ""
        }
        $("a[name='page']").each(function () {
            var href = $(this).attr("href");
            $(this).attr("href", href + "&keywords=" + keywords)
        });
    });

    function GetQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) {
            return unescape(decodeURI(r[2]));
        } else {
            return null;
        }
    }
</script>
</body>
</html>
